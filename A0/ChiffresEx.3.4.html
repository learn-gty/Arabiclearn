<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Exercice de chiffres arabes</title>
    <style>
        :root {
            --pal-red: #E4312b;
            --pal-black: #000;
            --pal-white: #fff;
            --pal-green: #149954;
            --container-bg: rgba(255,255,255,0.98);
            --container-border: #ddd;
            --button-bg: var(--pal-black);
            --button-text: var(--pal-white);
            --button-hover-bg: var(--pal-red);
            --button-hover-text: var(--pal-white);
            --stats-bg: #f4f4f4;
        }

        body.dark-mode {
            --container-bg: rgba(24,24,24,0.96);
            --container-border: #444;
            --button-bg: var(--pal-black);
            --button-text: var(--pal-white);
            --button-hover-bg: var(--pal-red);
            --button-hover-text: var(--pal-white);
            --stats-bg: #232323;
        }

        body {
            min-height: 100vh;
            font-family: 'Quicksand', Arial, sans-serif;
            background:
                linear-gradient(to bottom, var(--pal-black) 0 33%, var(--pal-white) 33% 66%, var(--pal-green) 66% 100%),
                linear-gradient(135deg, var(--pal-red) 0 32%, transparent 32% 100%);
            color: var(--pal-black);
            margin: 0;
            padding: 0;
            line-height: 1.1;
        }

        body::before {
            content: "";
            position: fixed;
            top: 0; left: 0;
            width: 30vw; height: 100vh;
            background: var(--pal-red);
            clip-path: polygon(0 0, 100% 50%, 0 100%);
            z-index: 0;
            opacity: 0.7;
            pointer-events: none;
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 900px;
            width: 99vw;
            margin: 10px auto 0 auto;
            background: var(--container-bg);
            border-radius: 8px;
            box-shadow: 0 0 6px rgba(0,0,0,0.08);
            padding: 15px 10px;
            border: 1px solid var(--container-border);
            display: flex;
            flex-direction: column;
            animation: slideIn 0.8s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1, h2 {
            font-weight: 700;
            font-size: 1.2rem;
            margin-bottom: 1rem;
            color: var(--pal-red);
            text-align: center;
            letter-spacing: 0.5px;
            animation: fadeInScale 1s ease-out;
        }

        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        #complement {
            font-weight: bold;
            color: var(--pal-red);
            font-size: 20px;
        }

        #question {
            font-size: 1.2rem;
            font-weight: 600;
            margin: 1rem 0;
            text-align: center;
            color: var(--pal-black);
            min-height: 40px;
            padding: 15px;
            background: var(--stats-bg);
            border-radius: 8px;
            border-left: 4px solid var(--pal-red);
        }

        body.dark-mode #question {
            color: var(--pal-white);
        }

        /* Tableau des réponses avec charte graphique */
        .tableau-reponses {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            background: var(--container-bg);
            border: 2px solid var(--pal-black);
            border-radius: 6px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            animation: tableSlide 0.6s ease-out;
            font-size: 0.85rem;
        }

        @keyframes tableSlide {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .tableau-reponses td {
            width: auto;
            min-width: 80px;
            height: 50px;
            border: 1px solid var(--pal-black);
            text-align: center;
            vertical-align: middle;
            position: relative;
            font-weight: 600;
            line-height: 1.1;
            transition: all 0.3s ease;
            padding: 8px;
        }

        /* Première ligne - Réponses possibles */
        .numero-cell {
            background-color: var(--pal-red);
            color: var(--pal-white);
            font-weight: bold;
            font-size: 16px;
            padding: 10px;
        }

        /* Deuxième ligne - Cases à cocher */
        .checkbox-cell {
            background-color: var(--stats-bg);
            padding: 8px;
            height: 40px;
        }

        body.dark-mode .checkbox-cell {
            background-color: var(--stats-bg);
        }

        .checkbox-cell:hover {
            background: rgba(228, 49, 43, 0.1);
            transform: scale(1.01);
        }

        .checkbox-cell input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            margin: 0;
            accent-color: var(--pal-red);
            transform: scale(1.3);
            transition: transform 0.2s ease;
        }

        .checkbox-cell input[type="checkbox"]:checked {
            animation: checkBounce 0.3s ease-out;
        }

        @keyframes checkBounce {
            0% { transform: scale(1.3); }
            50% { transform: scale(1.6); }
            100% { transform: scale(1.3); }
        }

        /* Styles pour les contrôles */
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 25px 0;
            font-size: 0.87rem;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            padding: 20px;
            background-color: var(--stats-bg);
            border-radius: 8px;
            border-left: 4px solid var(--pal-red);
        }

        body.dark-mode .controls {
            background-color: var(--stats-bg);
        }

        .controls:hover {
            transform: translateY(-2px);
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
        }

        input[type="number"], select {
            padding: 8px 12px;
            margin-left: 10px;
            border: 2px solid var(--pal-black);
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            color: var(--pal-black);
            background: var(--container-bg);
            transition: all 0.3s ease;
        }

        body.dark-mode input[type="number"], 
        body.dark-mode select {
            color: var(--pal-white);
            border-color: var(--pal-white);
            background: #232323;
        }

        input[type="number"]:focus, select:focus {
            border-color: var(--pal-green);
            outline: none;
            box-shadow: 0 0 0 2px rgba(20, 153, 84, 0.2);
        }

        .buttons {
            margin-top: 25px;
            text-align: center;
        }

        button {
            background-color: var(--button-bg);
            color: var(--button-text);
            border: 1px solid var(--pal-black);
            border-radius: 4px;
            padding: 12px 25px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.18s ease;
            white-space: nowrap;
            line-height: 1;
            margin: 0 10px;
        }

        button:hover:not(:disabled) {
            background-color: var(--button-hover-bg);
            color: var(--button-hover-text);
            border: 1px solid var(--pal-red);
            transform: translateY(-1px);
        }

        button:active {
            transform: translateY(1px);
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .feedback {
            font-weight: 700;
            min-height: 20px;
            margin: 1rem 0;
            text-align: center;
            font-size: 0.9rem;
            transition: all 0.3s;
            padding: 12px;
            border-radius: 4px;
        }

        .success {
            background: rgba(20, 153, 84, 0.15);
            border-left: 4px solid var(--pal-green);
            color: var(--pal-green);
        }

        .error {
            background: rgba(228, 49, 43, 0.15);
            border-left: 4px solid var(--pal-red);
            color: var(--pal-red);
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .container {
                max-width: 100vw;
                padding: 8px 4vw;
                margin: 2vw auto 0 auto;
            }
            
            .controls {
                justify-content: center;
                flex-direction: column;
                gap: 8px;
            }
            
            .tableau-reponses td {
                font-size: 14px;
                height: 45px;
                min-width: 60px;
            }
            
            .checkbox-cell input[type="checkbox"] {
                width: 18px;
                height: 18px;
                transform: scale(1.1);
            }
        }

        /* Meta viewport déjà présent, vérifiez qu'il soit bien dans le <head> */
/* <meta name="viewport" content="width=device-width, initial-scale=1.0"> */

/* Améliorations responsive pour le tableau */
.tableau-reponses {
    width: 100%;
    border-collapse: collapse;
    margin: 25px 0;
    background: var(--container-bg);
    border: 2px solid var(--pal-black);
    border-radius: 6px;
    overflow-x: auto; /* Scroll horizontal si nécessaire */
    display: block;
    white-space: nowrap;
}

.tableau-reponses tr {
    display: table;
    width: 100%;
    table-layout: fixed;
}

.tableau-reponses td {
    width: 10%;
    min-width: 50px; /* Taille minimum pour mobile */
    height: 45px;
    border: 1px solid var(--pal-black);
    text-align: center;
    vertical-align: middle;
    font-size: 14px;
    padding: 4px 2px;
}

/* Responsive breakpoints spécifiques */
@media (max-width: 768px) {
    .container {
        max-width: 100vw;
        width: 95vw;
        padding: 10px 5px;
        margin: 5px auto 0 auto;
    }

    /* Titre plus petit sur mobile */
    h1, h2 {
        font-size: 1rem;
        margin-bottom: 0.8rem;
    }

    /* Question adaptée */
    #question {
        font-size: 0.9rem;
        padding: 10px;
        margin: 0.8rem 0;
    }

    /* Tableau responsive */
    .tableau-reponses {
        font-size: 0.8rem;
        margin: 15px 0;
    }

    .tableau-reponses td {
        min-width: 40px;
        height: 40px;
        font-size: 12px;
        padding: 2px 1px;
    }

    .numero-cell {
        font-size: 13px;
        padding: 6px 2px;
    }

    .checkbox-cell input[type="checkbox"] {
        width: 16px;
        height: 16px;
        transform: scale(1.1);
    }

    /* Contrôles en colonne sur mobile */
    .controls {
        flex-direction: column;
        gap: 10px;
        padding: 15px 10px;
        margin: 15px 0;
    }

    .control-group {
        flex-direction: column;
        gap: 5px;
        width: 100%;
        text-align: center;
    }

    /* Boutons adaptés */
    .buttons {
        margin-top: 20px;
        display: flex;
        flex-direction: column;
        gap: 10px;
        align-items: center;
    }

    button {
        width: 80%;
        max-width: 200px;
        padding: 12px 15px;
        font-size: 14px;
    }

    /* Inputs plus grands sur mobile */
    input[type="number"], select {
        width: 100%;
        max-width: 150px;
        padding: 10px;
        font-size: 16px; /* Évite le zoom sur iOS */
        margin: 5px 0;
    }

    /* Feedback adapté */
    .feedback {
        font-size: 0.85rem;
        padding: 10px;
        margin: 0.8rem 0;
    }
}

@media (max-width: 480px) {
    /* Très petits écrans */
    .container {
        width: 98vw;
        padding: 8px 3px;
    }

    .tableau-reponses td {
        min-width: 35px;
        height: 35px;
        font-size: 11px;
    }

    .numero-cell {
        font-size: 12px;
        padding: 4px 1px;
    }

    .checkbox-cell input[type="checkbox"] {
        width: 14px;
        height: 14px;
        transform: scale(1);
    }

    h1, h2 {
        font-size: 0.9rem;
    }

    #question {
        font-size: 0.8rem;
        padding: 8px;
    }

    button {
        width: 90%;
        padding: 10px;
        font-size: 13px;
    }
}

/* Orientation paysage sur mobile */
@media (max-width: 768px) and (orientation: landscape) {
    .container {
        margin: 2px auto 0 auto;
        padding: 5px;
    }

    .tableau-reponses {
        margin: 10px 0;
    }

    .controls {
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: center;
    }

    .buttons {
        flex-direction: row;
        justify-content: center;
    }

    button {
        width: auto;
        min-width: 120px;
    }
}

/* Amélioration du touch sur mobile */
@media (pointer: coarse) {
    button, input[type="checkbox"], input[type="number"], select {
        min-height: 44px; /* Taille recommandée pour le touch */
    }

    .checkbox-cell {
        padding: 12px 8px;
    }

    .checkbox-cell input[type="checkbox"] {
        width: 20px;
        height: 20px;
        transform: scale(1.3);
    }
}

/* Prévention du zoom sur les inputs iOS */
@supports (-webkit-touch-callout: none) {
    input[type="number"], select {
        font-size: 16px;
    }
}


/* Cases à cocher plus petites */
.checkbox-cell input[type="checkbox"] {
    width: 14px;
    height: 14px;
    cursor: pointer;
    margin: 0;
    accent-color: var(--pal-red);
    transform: scale(1.0); /* Réduit de 1.3 à 1.0 */
    transition: transform 0.2s ease;
}

/* Texte des réponses plus gros */
.numero-cell {
    background-color: var(--pal-red);
    color: var(--pal-white);
    font-weight: bold;
    font-size: 20px; /* Augmenté de 16px à 20px */
    padding: 12px; /* Augmenté de 10px à 12px */
    line-height: 1.2;
}

/* Responsive - Cases encore plus petites sur mobile */
@media (max-width: 768px) {
    .checkbox-cell input[type="checkbox"] {
        width: 12px;
        height: 12px;
        transform: scale(0.9); /* Encore plus petit sur mobile */
    }
    
    .numero-cell {
        font-size: 18px; /* Légèrement réduit sur mobile mais toujours plus gros */
        padding: 10px;
    }
}

@media (max-width: 480px) {
    .checkbox-cell input[type="checkbox"] {
        width: 10px;
        height: 10px;
        transform: scale(0.8);
    }
    
    .numero-cell {
        font-size: 16px;
        padding: 8px;
    }
}

/* Animation des cases à cocher ajustée */
.checkbox-cell input[type="checkbox"]:checked {
    animation: checkBounceSmall 0.3s ease-out;
}

@keyframes checkBounceSmall {
    0% { transform: scale(1.0); }
    50% { transform: scale(1.2); }
    100% { transform: scale(1.0); }
}

/* Remplacer la section .tableau-reponses td */
.tableau-reponses td {
    width: auto;
    min-width: 90px; /* Augmenté pour accommoder le texte plus gros */
    height: 55px; /* Augmenté de 50px à 55px */
    border: 1px solid var(--pal-black);
    text-align: center;
    vertical-align: middle;
    position: relative;
    font-weight: 600;
    line-height: 1.2; /* Amélioré pour le texte plus gros */
    transition: all 0.3s ease;
    padding: 10px; /* Augmenté de 8px à 10px */
}
/* 1. Activer le responsive design */
@media screen and (max-width: 600px) {
  html {
    font-size: 16px;
  }

  /* 2. Rendre les tableaux fluides */
  table {
    width: 100%;
    display: block;
    overflow-x: auto;
    border-collapse: collapse;
  }

  /* 3. Transformer les tableaux en listes sur mobile */
  table.responsive-table thead {
    display: none;
  }
  table.responsive-table, 
  table.responsive-table tbody, 
  table.responsive-table tr, 
  table.responsive-table td {
    display: block;
    width: 100%;
  }
  table.responsive-table tr {
    margin-bottom: 1.5em;
    border-bottom: 1px solid #ddd;
    padding-bottom: 1em;
  }
  table.responsive-table td {
    text-align: left;
    padding: 0.5em 0;
    position: relative;
  }
  table.responsive-table td:before {
    content: attr(data-label);
    font-weight: bold;
    display: block;
    margin-bottom: 0.3em;
    color: #444;
  }

  /* 4. Agrandir les cases à cocher pour le tactile */
  input[type="checkbox"] {
    width: 1.5em;
    height: 1.5em;
    accent-color: #007bff; /* couleur personnalisée */
    margin-right: 0.5em;
  }

  /* 5. Espacer les éléments interactifs */
  label, .form-group {
    margin-bottom: 1em;
    display: block;
  }

  /* 6. Rendre les boutons plus larges et plus accessibles */
  button, input[type="submit"] {
    width: 100%;
    padding: 1em;
    font-size: 1.1em;
    margin-bottom: 1em;
    border-radius: 0.5em;
  }
}

.menu-hamburger {
  position: fixed;
  top: 1rem;
  left: 1rem;
  z-index: 1100;
}

.menu-icon {
  display: flex;
  flex-direction: column;
  justify-content: center;
  width: 40px;
  height: 40px;
  cursor: pointer;
  transition: transform 0.3s ease;
}

.menu-icon span {
  height: 3px;
  width: 100%;
  background-color: #333;
  margin: 5px 0;
  border-radius: 2px;
  transition: 0.4s ease;
}

#menu-toggle {
  display: none;
}

/* Menu latéral moderne */
.menu {
  position: fixed;
  top: 0;
  left: -260px;
  width: 240px;
  height: 100vh;
  background: #ffffff;
  box-shadow: 4px 0 20px rgba(0, 0, 0, 0.1);
  border-top-right-radius: 16px;
  border-bottom-right-radius: 16px;
  padding: 60px 0 20px 0;
  list-style: none;
  transition: left 0.35s ease;
  font-family: 'Segoe UI', Arial, sans-serif;
  overflow-y: auto;
}

.menu li {
  margin: 0;
  padding: 0;
}

.menu li a {
  display: block;
  padding: 14px 24px;
  color: #333;
  font-size: 1rem;
  text-decoration: none;
  border-left: 4px solid transparent;
  transition: background-color 0.25s, border-color 0.25s;
}

.menu li a:hover {
  background-color: #f5f5f5;
  color: #007a33;
  border-left: 4px solid #007a33;
}

/* Menu visible quand le toggle est activé */
#menu-toggle:checked ~ .menu {
  left: 0;
}

/* Animation du bouton hamburger → X */
#menu-toggle:checked + .menu-icon span:nth-child(1) {
  transform: rotate(45deg) translate(5px, 5px);
}
#menu-toggle:checked + .menu-icon span:nth-child(2) {
  opacity: 0;
}
#menu-toggle:checked + .menu-icon span:nth-child(3) {
  transform: rotate(-45deg) translate(5px, -5px);
}

/* Responsive amélioré */
@media (max-width: 600px) {
  .menu {
    width: 80vw;
    max-width: 300px;
    border-radius: 0 16px 16px 0;
  }

  .menu li a {
    font-size: 0.95rem;
    padding: 12px 20px;
  }

  .menu-icon {
    width: 36px;
    height: 36px;
  }

  .menu-icon span {
    margin: 4px 0;
  }


    #content-wrapper {
    z-index: 0;
    position: relative;
  }

 

  #loader-overlay {
    z-index: 10000;
  }
}


    </style>
</head>
<body>
    <!-- Menu Hamburger Responsive -->
<nav class="menu-hamburger">
  <input type="checkbox" id="menu-toggle" />
  <label for="menu-toggle" class="menu-icon">
    <span></span>
    <span></span>
    <span></span>
  </label>
  <ul class="menu">
    <li><a href="../index.html">Accueil</a></li>
    <li><a href="ar50.html">Séquences & Leçons</a></li>
    <li><a href="pronoms.html">Pronoms</a></li>
    <li><a href="pronomsPossessifs.html">Possessifs</a></li>
    <li><a href="LunaireSolaire.html">Lettres Lunaires/Solaires</a></li>
    <li><a href="chiffres.3.html">Exercice Chiffres </a></li>
    <li><a href="ChiffresEx.3.4.html">Autres Exercice Chiffres</a></li> 
    <li><a href="Verb.1.1.html">Conjugaison (1er verbes)</a></li> 
    <li><a href="PageUnderConstruction.html">Suite...</a></li> </ul>
</nav>

    <div class="container">
        <div class="exercise-section">
            <h2>Complément et autres <span id="complement"></span></h2>
        </div>

        <div id="question">Choisissez votre mode d'apprentissage</div>

        <!-- Tableau des réponses possibles avec cases à cocher -->
        <table class="tableau-reponses" id="tableauReponses" style="display: none;">
            <tr id="ligneReponses">
                <!-- Les réponses seront générées dynamiquement -->
            </tr>
            <tr id="ligneCoches">
                <!-- Les cases à cocher seront générées dynamiquement -->
            </tr>
        </table>

        <div class="controls">
            <div class="control-group">
                <label for="maxSum">Somme cible (max 20) :</label>
                <input type="number" id="maxSum" value="10" min="1" max="20">
            </div>

            <div class="control-group">
                <label for="mode">Mode :</label>
                <select id="mode">
                    <option value="arabe-ecriture">Chiffre arabe → Écriture arabe</option>
                    <option value="arabe-indien">Chiffre arabe → Chiffre indien</option>
                    <option value="arabe-translitteration">Chiffre arabe → Translittération</option>
                      <option value="indien-translitteration">Chiffre indien → Translittération</option>
                    <option value="ecriture-arabe">Écriture arabe → Chiffre arabe</option>
                    <option value="indien-arabe">Chiffre indien → Chiffre arabe</option>
                    <option value="translitteration-arabe">Translittération → Chiffre arabe</option>
                    <option value="translitteration-indien">Translittération → Chiffre indien</option>
                     <option value="translitteration-ecriture">Translittération → Écriture arabe</option>
                <!--     <option value="complement-arabe">Complément arithmétique → Chiffre arabe</option> -->
                    <option value="complement-ecriture">Complément arithmétique → Écriture arabe</option>
                    <option value="complement-indien">Complément arithmétique → Chiffre indien</option>
                    <!-- <option value="addition-arabe">Addition simple → Chiffre arabe</option> -->
                    <option value="addition-ecriture">Addition simple → Écriture arabe</option>
                     <option value="addition-indien">Addition simple → Chiffre indien</option>
                    <!-- <option value="soustraction-arabe">Soustraction simple → Chiffre arabe</option> -->
                    <!-- <option value="sequence-arabe">Séquence numérique → Chiffre arabe</option> -->
                    <option value="sequence-indien">Séquence numérique → Chiffre indien</option>    
                    <option value="sequence-ecriture">Séquence numérique → Écriture arabe</option>
                    <option value="comparaison-indien">Comparaison (plus grand/petit) → Chiffre indien</option>
                    <option value="comparaison-ecriture">Comparaison (plus grand/petit) → Écriture arabe</option>
                    
                </select>
            </div>

            <div class="control-group">
                <label for="difficulte">Difficulté :</label>
                <select id="difficulte">
                    <option value="facile">Facile (0-10)</option>
                    <option value="moyen">Moyen (0-20)</option>
                    <option value="difficile">Difficile (0-100)</option>
                </select>
            </div>
        </div>

        <div class="buttons">
            <button type="button" id="nouvelleQuestion">Nouvelle question</button>
            <button type="button" id="valider">Valider</button>
            <button type="button" id="aide">Aide</button>
        </div>

        <div id="feedback" class="feedback"></div>
    </div>

   <script>

const donneesArabes = {
    chiffres: ['٠', '١', '٢', '٣', '٤', '٥', '٦', '٧', '٨', '٩','١٠'],
    ecriture: ['صِفْر', 'وَاحِد', 'إثْنان', 'ثَلاثة', 'أرْبَعة', 'خَمْسة', 'سِتّة', 'سَبْعة', 'ثَمانية', 'تِسْعة', 'عَشَرَة'],
    translitteration: [
  'sifr',      // 0
  'wahid',     // 1
  'ithnan',    // 2
  'thalatha',  // 3
  "arba'a",    // 4
  'khamsa',    // 5
  'sitta',     // 6
  "sab'a",     // 7
  'thamaniya', // 8
  "tis'a",     // 9
  "'ashara"    // 10
],
    ecritureEtendue: {
        10: 'عَشَرة', 11: 'أحَدَ عَشَر', 12: 'إثنا عَشَر', 13: 'ثلاثة عَشَر',
        14: 'أربَعة عَشَر', 15: 'خَمْسة عَشَر', 16: 'سِتّة عَشَر', 17: 'سَبْعة عَشَر',
        18: 'ثَمانية عَشَر', 19: 'تِسْعة عَشَر', 20: 'عِشْرون'
    }
};

let reponseCorrecte = null;
const inputLibre = document.createElement('input');
inputLibre.type = 'text';
inputLibre.id = 'reponseLibre';
inputLibre.placeholder = 'Écris ta réponse ici';
inputLibre.style.display = 'none';
inputLibre.style.textAlign = 'center';
inputLibre.style.fontSize = '18px';
inputLibre.style.margin = '20px auto';
inputLibre.style.display = 'block';
inputLibre.style.padding = '10px';
inputLibre.style.border = '2px solid #000';
inputLibre.style.borderRadius = '6px';

document.getElementById('valider').insertAdjacentElement('beforebegin', inputLibre);

document.getElementById('mode').addEventListener('change', genererQuestion);
document.getElementById('difficulte').addEventListener('change', genererQuestion);
document.getElementById('maxSum').addEventListener('change', genererQuestion);
document.getElementById('nouvelleQuestion').addEventListener('click', genererQuestion);
document.getElementById('valider').addEventListener('click', validerReponse);





function genererQuestion() {
    const mode = document.getElementById('mode').value;
    const difficulte = document.getElementById('difficulte').value;
    const maxSum = parseInt(document.getElementById('maxSum').value);
    let maxRange = difficulte === 'facile' ? 10 : difficulte === 'moyen' ? 20 : 100;
    maxRange = Math.min(maxRange, maxSum);

    document.getElementById('feedback').innerHTML = '';
    document.getElementById('feedback').className = 'feedback';
    document.getElementById('tableauReponses').style.display = 'table';
    inputLibre.style.display = 'none';
    inputLibre.value = '';

    const modesSaisie = ['ecriture-arabe', 'indien-arabe', 'translitteration-arabe'];
    const modesChoix = [
        'arabe-ecriture', 'arabe-indien', 'arabe-translitteration',
        'translitteration-indien', 'translitteration-ecriture','indien-translitteration'
    ];
    const modesOperation = ['complement-ecriture', 'complement-indien', 'addition-ecriture', 'addition-indien'];
    const modesSequence = ['sequence-indien', 'sequence-ecriture'];
    const modesComparaison = ['comparaison-indien', 'comparaison-ecriture'];

    if (modesSaisie.includes(mode)) {
        genererQuestionAvecInputLibre(mode, maxRange);
    } else if (modesChoix.includes(mode)) {
        genererQuestionAvecTableau(mode, maxRange);
    } else if (mode.startsWith('complement-')) {
        genererQuestionComplement(mode, maxRange);
    } else if (mode.startsWith('addition-')) {
        genererQuestionAddition(mode, maxRange);
    } else if (mode.startsWith('sequence-')) {
        genererQuestionSequence(mode, maxRange);
    } else if (mode.startsWith('comparaison-')) {
        genererQuestionComparaison(mode, maxRange);
    }
}

function genererQuestionAvecInputLibre(mode, maxRange) {
    const question = document.getElementById('question');
    const tableau = document.getElementById('tableauReponses');
    tableau.style.display = 'none';
    inputLibre.style.display = 'block';

    const n = Math.floor(Math.random() * (maxRange + 1));
    reponseCorrecte = n;

    let prompt = '';
    if (mode === 'ecriture-arabe') prompt = `Quel est le chiffre arabe (symbole) de : ${getEcriture(n)}`;
    if (mode === 'indien-arabe') prompt = `Quel est le chiffre arabe (symbole) de : ${convertirEnIndien(n)}`;
    if (mode === 'translitteration-arabe') prompt = `Quel est le chiffre arabe (symbole) de : ${getTranslit(n)}`;

    question.innerHTML = prompt;
}

function genererQuestionAvecTableau(mode, maxRange) {
    const question = document.getElementById('question');
    const nombre = Math.floor(Math.random() * (maxRange + 1));
    reponseCorrecte = nombre;

    let texte = '';
    if (mode === 'arabe-ecriture') texte = `Quelle est l'écriture arabe de : ${nombre}`;
    if (mode === 'arabe-indien') texte = `Quel est le chiffre indien de : ${nombre}`;
    if (mode === 'arabe-translitteration') texte = `Quelle est la translittération de : ${nombre}`;
    if (mode === 'translitteration-indien') texte = `Quel est le chiffre indien de : ${getTranslit(nombre)}`;
    if (mode === 'translitteration-ecriture') texte = `Quelle est l'écriture arabe de : ${getTranslit(nombre)}`;
    if (mode === 'indien-translitteration')   texte = `Quelle est la translittération de : ${convertirEnIndien(nombre)}`;


    question.innerHTML = texte;
    const options = genererOptions(nombre, maxRange);
    creerTableauReponses(options, mode);
}

function genererQuestionComplement(mode, maxRange) {
            const tableau = document.getElementById('tableauReponses');
            const question = document.getElementById('question');
            
            tableau.style.display = 'table';
            
            const cible = Math.floor(Math.random() * maxRange) + 5;
            const nombre = Math.floor(Math.random() * cible);
            reponseCorrecte = cible - nombre;
            
           let texteQuestion = `Quel est le complément de ${nombre} pour atteindre ${cible} ?`;
            question.innerHTML = texteQuestion;
            
            const options = genererOptions(reponseCorrecte, maxRange);
            creerTableauReponses(options, mode);
        }

function genererQuestionAddition(mode, maxRange) {
            const tableau = document.getElementById('tableauReponses');
            const question = document.getElementById('question');
            
            tableau.style.display = 'table';
            
            const a = Math.floor(Math.random() * (maxRange/2));
            const b = Math.floor(Math.random() * (maxRange/2));
            reponseCorrecte = a + b;
            
            let texteQuestion = `${a} + ${b} = ?`;
            question.innerHTML = texteQuestion;
            
           const options = genererOptions(reponseCorrecte, maxRange);
            creerTableauReponses(options, mode);
        }

function genererQuestionSequence(mode, maxRange) {
            const tableau = document.getElementById('tableauReponses');
            const question = document.getElementById('question');
            
            tableau.style.display = 'table';
            
            const debut = Math.floor(Math.random() * (maxRange - 5));
            const sequence = [debut, debut + 1, debut + 2, '?', debut + 4];
            reponseCorrecte = debut + 3;
            
            let texteQuestion = `Complétez la séquence : ${sequence.join(', ')}`;
            question.innerHTML = texteQuestion;
            
            const options = genererOptions(reponseCorrecte, maxRange);
            creerTableauReponses(options, mode);
        }

function genererQuestionComparaison(mode, maxRange) {
            const tableau = document.getElementById('tableauReponses');
            const question = document.getElementById('question');
            
            tableau.style.display = 'table';
            
            const a = Math.floor(Math.random() * maxRange);
            const b = Math.floor(Math.random() * maxRange);
            const operation = Math.random() > 0.5 ? 'plus grand' : 'plus petit';
            
            if (operation === 'plus grand') {
                reponseCorrecte = Math.max(a, b);
                question.innerHTML = `Quel est le plus grand nombre entre ${a} et ${b} ?`;
            } else {
                reponseCorrecte = Math.min(a, b);
                question.innerHTML = `Quel est le plus petit nombre entre ${a} et ${b} ?`;
            }
            
            const options = [a, b, Math.floor(Math.random() * maxRange), Math.floor(Math.random() * maxRange)];
            const optionsUniques = [...new Set(options)].slice(0, 6);
            creerTableauReponses(optionsUniques, mode);
        }


function genererOptions(reponseCorrecte, maxRange) {
            const options = new Set([reponseCorrecte]);
            
            while (options.size < 8) {
                const option = Math.floor(Math.random() * (maxRange + 1));
                options.add(option);
            }
            
            return Array.from(options).sort(() => Math.random() - 0.5);
        }

function creerTableauReponses(options, mode) {
            const ligneReponses = document.getElementById('ligneReponses');
            const ligneCoches = document.getElementById('ligneCoches');
            
            ligneReponses.innerHTML = '';
            ligneCoches.innerHTML = '';
            
            options.forEach((option, index) => {
                // Cellule de réponse
                const celluleReponse = document.createElement('td');
                celluleReponse.className = 'numero-cell';
                
                let texteReponse = option;
                if (mode.endsWith('ecriture')) {
                    texteReponse = option <= 10 ? donneesArabes.ecriture[option] : donneesArabes.ecritureEtendue[option] || option;
                } else if (mode.endsWith('indien')) {
                    texteReponse = option <= 10 ? donneesArabes.chiffres[option] : convertirEnIndien(option);
                } else if (mode.endsWith('translitteration')) {
                    texteReponse = option <= 10 ? donneesArabes.translitteration[option] : option;
                }
                
                celluleReponse.textContent = texteReponse;
                ligneReponses.appendChild(celluleReponse);
                
                // Cellule de case à cocher
                const celluleCoche = document.createElement('td');
                celluleCoche.className = 'checkbox-cell';
                
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = `check${index}`;
                checkbox.name = 'reponse';
                // checkbox.value = option;
                checkbox.value = texteReponse; // Ce qui est affiché à l'utilisateur

                celluleCoche.appendChild(checkbox);
                ligneCoches.appendChild(celluleCoche);
            });
        }

function afficherOption(valeur, mode) {
    if (mode.includes('-ecriture')) return getEcriture(valeur);
    if (mode.includes('-indien')) return convertirEnIndien(valeur);
    if (mode.includes('-translitteration')) return getTranslit(valeur);
    return valeur;
}

function convertirEnIndien(nombre) {
    return nombre.toString().split('').map(d => donneesArabes.chiffres[parseInt(d)] || d).join('');
}

function getEcriture(n) {
    return n <= 10 ? donneesArabes.ecriture[n] : donneesArabes.ecritureEtendue[n] || n;
}

function getTranslit(n) {
    return n <= 10 ? donneesArabes.translitteration[n] : n;
}


// function validerReponse() {
//     const feedback = document.getElementById('feedback');
//     const mode = document.getElementById('mode').value;
//     const isInputLibre = ['ecriture-arabe', 'indien-arabe', 'translitteration-arabe'].includes(mode);

//     if (isInputLibre) {
//         const val = inputLibre.value.trim();
//         if (val === '') {
//             feedback.textContent = 'Veuillez entrer une réponse.';
//             feedback.className = 'feedback error';
//             return;
//         }
//         if (parseInt(val) === reponseCorrecte) {
//             feedback.innerHTML = '✅ Correct !';
//             feedback.className = 'feedback success';
//             setTimeout(() => { genererQuestion(); }, 1200);
//         } else {
//             feedback.innerHTML = `❌ Incorrect. Réponse attendue : ${reponseCorrecte}`;
//             feedback.className = 'feedback error';
//         }
//         return;
//     }

//     const checked = [...document.querySelectorAll('input[name="reponse"]:checked')];
//     if (checked.length !== 1) {
//         feedback.textContent = 'Veuillez sélectionner une seule réponse.';
//         feedback.className = 'feedback error';
//         return;
//     }
//     const val = parseInt(checked[0].value);
//     if (val === reponseCorrecte) {
//         feedback.innerHTML = '✅ Correct !';
//         feedback.className = 'feedback success';
//         setTimeout(() => { genererQuestion(); }, 1200);
//     } else {
//         feedback.innerHTML = `❌ Mauvaise réponse. Réponse attendue : ${reponseCorrecte}`;
//         feedback.className = 'feedback error';
//     }
// }


function validerReponse() {
    const feedback = document.getElementById('feedback');
    const mode = document.getElementById('mode').value;
    const isInputLibre = ['ecriture-arabe', 'indien-arabe', 'translitteration-arabe'].includes(mode);

    // Saisie libre
    if (isInputLibre) {
        const val = inputLibre.value.trim();
        if (val === '') {
            feedback.textContent = 'Veuillez entrer une réponse.';
            feedback.className = 'feedback error';
            return;
        }
        if (parseInt(val) === reponseCorrecte) {
            feedback.innerHTML = '✅ Correct !';
            feedback.className = 'feedback success';
            setTimeout(() => { genererQuestion(); }, 1200);
        } else {
            feedback.innerHTML = `❌ Incorrect. Réponse attendue : ${reponseCorrecte}`;
            feedback.className = 'feedback error';
        }
        return;
    }

    // Mode avec tableau de réponses
    const checked = [...document.querySelectorAll('input[name="reponse"]:checked')];
    if (checked.length !== 1) {
        feedback.textContent = 'Veuillez sélectionner une seule réponse.';
        feedback.className = 'feedback error';
        return;
    }

    const valeurCochee = checked[0].value;

    // Génère la forme attendue selon le mode
    let bonneReponseFormatee = '';
    if (mode.endsWith('ecriture')) {
        bonneReponseFormatee = getEcriture(reponseCorrecte);
    } else if (mode.endsWith('indien')) {
        bonneReponseFormatee = convertirEnIndien(reponseCorrecte);
    } else if (mode.endsWith('translitteration')) {
        bonneReponseFormatee = getTranslit(reponseCorrecte);
    } else {
        bonneReponseFormatee = reponseCorrecte.toString(); // fallback
    }

    if (valeurCochee === bonneReponseFormatee) {
        feedback.innerHTML = '✅ Correct !';
        feedback.className = 'feedback success';
        setTimeout(() => { genererQuestion(); }, 1200);
    } else {
        feedback.innerHTML = `❌ Mauvaise réponse. Réponse attendue : ${bonneReponseFormatee}`;
        feedback.className = 'feedback error';
    }
}


genererQuestion();







</script>
<!-- Popup d’aide -->
<div id="popupAide" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:10000; align-items:center; justify-content:center;">
    <div style="background:white; padding:10px; border-radius:6px; width:95%; max-width:500px; position:relative; font-family:Arial, sans-serif;">
        <button onclick="fermerPopup()" style="position:absolute; top:6px; right:8px; background:none; border:none; font-size:18px; cursor:pointer;">❌</button>
        <h3 style="text-align:center; margin:8px 0;">Aide – Chiffres 0 à 10</h3>
        <table style="width:100%; border-collapse:collapse; font-size:14px;">
            <thead>
                <tr style="background:#eee;">
                    <th style="padding:4px; border:1px solid #ccc;">Arabe</th>
                    <th style="padding:4px; border:1px solid #ccc;">Écriture</th>
                    <th style="padding:4px; border:1px solid #ccc;">Indien</th>
                    <th style="padding:4px; border:1px solid #ccc;">Translittération</th>
                </tr>
            </thead>
            <tbody id="contenuAideTableau"></tbody>
        </table>
        <div style="text-align:center; margin-top:10px;">
            <button onclick="fermerPopup()" style="padding:6px 12px; font-size:14px; border:none; background:#E4312b; color:white; border-radius:4px; cursor:pointer;">Fermer</button>
        </div>
    </div>
</div>
<script>
// ✅ Affiche la popup au clic
document.getElementById('aide').addEventListener('click', function () {
    const tbody = document.getElementById('contenuAideTableau');
    tbody.innerHTML = '';

    for (let i = 0; i <= 10; i++) {
        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td style="padding:2px; border:1px solid #ccc; text-align:center;">${i}</td>
            <td style="padding:2px; border:1px solid #ccc; text-align:center;">${donneesArabes.ecriture[i]}</td>
            <td style="padding:2px; border:1px solid #ccc; text-align:center;">${donneesArabes.chiffres[i]}</td>
            <td style="padding:2px; border:1px solid #ccc; text-align:center;">${donneesArabes.translitteration[i]}</td>
        `;
        tbody.appendChild(tr);
    }

    document.getElementById('popupAide').style.display = 'flex';
});

// ✅ Ferme la popup
function fermerPopup() {
    document.getElementById('popupAide').style.display = 'none';
}
</script>

<script>
  const menuToggle = document.getElementById('menu-toggle');
  const menuIcon = document.querySelector('.menu-icon');

  let autoCloseTimer = null;

  // Quand on clique sur l’icône du menu
  menuIcon.addEventListener('click', () => {
    // Petite attente pour laisser le menu s’ouvrir via le CSS
    setTimeout(() => {
      if (menuToggle.checked) {
        // Si menu ouvert, lancer le minuteur
        if (autoCloseTimer) clearTimeout(autoCloseTimer); // Réinitialise si déjà lancé
        autoCloseTimer = setTimeout(() => {
          menuToggle.checked = false; // Replier le menu
        }, 5000); // 5 secondes
      }
    }, 50); // on laisse le temps à l’état "checked" de s’activer
  });
</script>
</body>
</html>
